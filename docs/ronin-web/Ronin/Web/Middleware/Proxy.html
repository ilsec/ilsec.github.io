<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf8" />
<title>
  Class: Ronin::Web::Middleware::Proxy
  
    &mdash; Ronin Web Documentation
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (P)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../../Ronin.html" title="Ronin (module)">Ronin</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Web.html" title="Ronin::Web (module)">Web</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Middleware.html" title="Ronin::Web::Middleware (module)">Middleware</a></span></span>
     &raquo; 
    <span class="title">Proxy</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Ronin::Web::Middleware::Proxy
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Base.html" title="Ronin::Web::Middleware::Base (class)">Base</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="Base.html" title="Ronin::Web::Middleware::Base (class)">Base</a></span></li>
          
            <li class="next">Ronin::Web::Middleware::Proxy</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/ronin/web/middleware/proxy.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>A Rack middleware for proxying requests.</p>

<pre class="code"><span class='use identifier id'>use</span> <span class='Ronin constant id'>Ronin</span><span class='colon2 op'>::</span><span class='Web constant id'>Web</span><span class='colon2 op'>::</span><span class='Middleware constant id'>Middleware</span><span class='colon2 op'>::</span><span class='Proxy constant id'>Proxy</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='proxy identifier id'>proxy</span><span class='bitor op'>|</span>
  <span class='proxy identifier id'>proxy</span><span class='dot token'>.</span><span class='every_request identifier id'>every_request</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='request identifier id'>request</span><span class='bitor op'>|</span>
    <span class='puts identifier id'>puts</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='url identifier id'>url</span>
  <span class='end end kw'>end</span>

  <span class='proxy identifier id'>proxy</span><span class='dot token'>.</span><span class='every_response identifier id'>every_response</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='response identifier id'>response</span><span class='bitor op'>|</span>
    <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
      <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;#{name}: #{value}&quot;</span>
    <span class='end end kw'>end</span>

    <span class='puts identifier id'>puts</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='body identifier id'>body</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>


  </div>
</div>
<div class="tags">
  
</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="HEADERS_BLACKLIST-constant" class="">HEADERS_BLACKLIST =
          <div class="docstring">
  <div class="discussion">
    <p>Blacklisted HTTP response Headers.</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='Set constant id'>Set</span><span class='lbrack token'>[</span>
  <span class='string val'>'Transfer-Encoding'</span>
<span class='rbrack token'>]</span>
</pre></dd>
      
    </dl>
  


  
  
  
  
  <h3 class="inherited">Constants inherited from <span class='object_link'><a href="Base.html" title="Ronin::Web::Middleware::Base (class)">Base</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Base.html#DEFAULT_STATUS-constant" title="Ronin::Web::Middleware::Base::DEFAULT_STATUS (constant)">DEFAULT_STATUS</a></span></p>

  
  
  
  
  
  


  
  
  
  <h2>Instance Attribute Summary</h2>
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="Base.html" title="Ronin::Web::Middleware::Base (class)">Base</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Base.html#default_headers-instance_method" title="Ronin::Web::Middleware::Base#default_headers (method)">default_headers</a></span>, <span class='object_link'><a href="Base.html#default_status-instance_method" title="Ronin::Web::Middleware::Base#default_status (method)">default_status</a></span></p>

  
  
  
  
  

  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#call-instance_method" title="#call (instance method)">- (Array, Response) <strong>call</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Receives incoming requests, proxies them, allowing manipulation
of the requests and their responses.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#every_request-instance_method" title="#every_request (instance method)">- (Proxy) <strong>every_request</strong> {|request| ... }</a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Uses the given block to intercept incoming requests.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#every_response-instance_method" title="#every_response (instance method)">- (Proxy) <strong>every_response</strong> {|response| ... }</a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Uses the given block to intercept proxied responses.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Proxy) <strong>initialize</strong>(app, options = {}) {|proxy| ... }</a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Creates a new <span class='object_link'><a href="" title="Ronin::Web::Middleware::Proxy (class)">Proxy</a></span> middleware.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#intercept-instance_method" title="#intercept (instance method)">- (Object) <strong>intercept</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Specifies which requests will be intercepted.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#proxy-instance_method" title="#proxy (instance method)">- (Response) <strong>proxy</strong>(request) </a>
    

    
  </span>
  
  
  <span class="note title protected">protected</span>
  
  
  <span class="private note title">Private</span>

  
    <span class="summary_desc"><div class='inline'><p>Proxies a request.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="Base.html" title="Ronin::Web::Middleware::Base (class)">Base</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Base.html#response-instance_method" title="Ronin::Web::Middleware::Base#response (method)">#response</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Helpers.html" title="Ronin::Web::Middleware::Helpers (module)">Helpers</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Helpers.html#mime_type_for-instance_method" title="Ronin::Web::Middleware::Helpers#mime_type_for (method)">#mime_type_for</a></span>, <span class='object_link'><a href="Helpers.html#response-instance_method" title="Ronin::Web::Middleware::Helpers#response (method)">#response</a></span>, <span class='object_link'><a href="Helpers.html#response_for-instance_method" title="Ronin::Web::Middleware::Helpers#response_for (method)">#response_for</a></span>, <span class='object_link'><a href="Helpers.html#sanitize_path-instance_method" title="Ronin::Web::Middleware::Helpers#sanitize_path (method)">#sanitize_path</a></span></p>

  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Ronin::Web::Middleware::Proxy (class)">Proxy</a></span></tt>) <strong>initialize</strong>(app, options = {}) {|proxy| ... }
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>Creates a new <span class='object_link'><a href="" title="Ronin::Web::Middleware::Proxy (class)">Ronin::Web::Middleware::Proxy</a></span> middleware.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>app</span>
      
      
        <span class='type'>(<tt>#call</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The application that the proxy middleware sits in front of.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Additional options.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <h3>Options Hash (<tt>options</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="name">:campaign</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>The name of the campaign who&rsquo;s targetted hosts will be
filtered by.</p>
</div>
        </tr>
      
        <li>
          <span class="name">:vhost</span>
          <span class="type">(<tt>String</tt>, <tt>Regexp</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>The Virtual-Host to filter.</p>
</div>
        </tr>
      
        <li>
          <span class="name">:ip</span>
          <span class="type">(<tt>String</tt>, <tt>IPAddr</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>The IP address or IP range to filter.</p>
</div>
        </tr>
      
        <li>
          <span class="name">:referer</span>
          <span class="type">(<tt>String</tt>, <tt>Regexp</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>The Referer URL or pattern to filter.</p>
</div>
        </tr>
      
        <li>
          <span class="name">:user_agent</span>
          <span class="type">(<tt>String</tt>, <tt>Regexp</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>The User-Agent string to filter.</p>
</div>
        </tr>
      
        <li>
          <span class="name">:when</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>Custom logic to filter requests by.</p>
</div>
        </tr>
      
    </ul>
  
<h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Web.html#proxy-class_method" title="Ronin::Web.proxy (method)">proxy</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>If a block is given, it will be passed the new proxy middleware.</p>
</div>
      
    </li>
  
</ul>
<h3>Yield Parameters:</h3>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>proxy</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Ronin::Web::Middleware::Proxy (class)">Proxy</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The new proxy middleware object.</p>
</div>
      
    </li>
  
</ul>
<h3>Since:</h3>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.3.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98
99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/web/middleware/proxy.rb', line 95</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='app identifier id'>app</span><span class='comma token'>,</span><span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='intercept identifier id'>intercept</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>

  <span class='super super kw'>super</span><span class='lparen token'>(</span><span class='app identifier id'>app</span><span class='comma token'>,</span><span class='options identifier id'>options</span><span class='comma token'>,</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="call-instance_method">
  
    - (<tt>Array</tt>, <tt><span class='object_link'><a href="Response.html" title="Ronin::Web::Middleware::Response (class)">Response</a></span></tt>) <strong>call</strong>(env) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>Receives incoming requests, proxies them, allowing manipulation
of the requests and their responses.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>env</span>
      
      
        <span class='type'>(<tt>Hash</tt>, <tt>Rack::Request</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The request.</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array</tt>, <tt><span class='object_link'><a href="Response.html" title="Ronin::Web::Middleware::Response (class)">Response</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The response.</p>
</div>
      
    </li>
  
</ul>
<h3>Since:</h3>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.3.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/web/middleware/proxy.rb', line 191</span>

<span class='def def kw'>def</span> <span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='env identifier id'>env</span><span class='rparen token'>)</span>
  <span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='ProxyRequest constant id'>ProxyRequest</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='env identifier id'>env</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='@rule ivar id'>@rule</span><span class='dot token'>.</span><span class='match? fid id'>match?</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='rparen token'>)</span>
    <span class='@every_request_block ivar id'>@every_request_block</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='@every_request_block ivar id'>@every_request_block</span>
  <span class='else else kw'>else</span>
    <span class='return return kw'>return</span> <span class='super super kw'>super</span><span class='lparen token'>(</span><span class='env identifier id'>env</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='print_info identifier id'>print_info</span> <span class='dstring node'>&quot;Proxying #{request.url} for #{request.address}&quot;</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
    <span class='print_debug identifier id'>print_debug</span> <span class='dstring node'>&quot;  #{name}: #{value}&quot;</span>
  <span class='end end kw'>end</span>

  <span class='response identifier id'>response</span> <span class='assign token'>=</span> <span class='proxy identifier id'>proxy</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='rparen token'>)</span>

  <span class='@every_response_block ivar id'>@every_response_block</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='response identifier id'>response</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='@every_response_block ivar id'>@every_response_block</span>

  <span class='print_info identifier id'>print_info</span> <span class='dstring node'>&quot;Returning proxied response for #{request.address}&quot;</span>
  <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
    <span class='print_debug identifier id'>print_debug</span> <span class='dstring node'>&quot;  #{name}: #{value}&quot;</span>
  <span class='end end kw'>end</span>

  <span class='return return kw'>return</span> <span class='response identifier id'>response</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="every_request-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Ronin::Web::Middleware::Proxy (class)">Proxy</a></span></tt>) <strong>every_request</strong> {|request| ... }
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>Uses the given block to intercept incoming requests.</p>


  </div>
</div>
<div class="tags">
  <h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>request</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The given block will receive every incoming request, before it
is proxied.</p>
</div>
      
    </li>
  
</ul>
<h3>Yield Parameters:</h3>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>request</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ProxyRequest.html" title="Ronin::Web::Middleware::ProxyRequest (class)">ProxyRequest</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A proxied request.</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Ronin::Web::Middleware::Proxy (class)">Proxy</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The proxy middleware.</p>
</div>
      
    </li>
  
</ul>
<h3>Since:</h3>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.3.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


151
152
153
154</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/web/middleware/proxy.rb', line 151</span>

<span class='def def kw'>def</span> <span class='every_request identifier id'>every_request</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='@every_request_block ivar id'>@every_request_block</span> <span class='assign token'>=</span> <span class='block identifier id'>block</span>
  <span class='return return kw'>return</span> <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="every_response-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Ronin::Web::Middleware::Proxy (class)">Proxy</a></span></tt>) <strong>every_response</strong> {|response| ... }
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>Uses the given block to intercept proxied responses.</p>


  </div>
</div>
<div class="tags">
  <h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>response</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The given block will receive every proxied response.</p>
</div>
      
    </li>
  
</ul>
<h3>Yield Parameters:</h3>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>response</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Response.html" title="Ronin::Web::Middleware::Response (class)">Response</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A proxied response.</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Ronin::Web::Middleware::Proxy (class)">Proxy</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The proxy middleware.</p>
</div>
      
    </li>
  
</ul>
<h3>Since:</h3>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.3.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


172
173
174
175</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/web/middleware/proxy.rb', line 172</span>

<span class='def def kw'>def</span> <span class='every_response identifier id'>every_response</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='@every_response_block ivar id'>@every_response_block</span> <span class='assign token'>=</span> <span class='block identifier id'>block</span>
  <span class='return return kw'>return</span> <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="intercept-instance_method">
  
    - (<tt>Object</tt>) <strong>intercept</strong>(options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>Specifies which requests will be intercepted.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Additional options.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <h3>Options Hash (<tt>options</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="name">:campaign</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>The name of the campaign who&rsquo;s targetted hosts will be
filtered by.</p>
</div>
        </tr>
      
        <li>
          <span class="name">:vhost</span>
          <span class="type">(<tt>String</tt>, <tt>Regexp</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>The Virtual-Host to filter.</p>
</div>
        </tr>
      
        <li>
          <span class="name">:ip</span>
          <span class="type">(<tt>String</tt>, <tt>IPAddr</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>The IP address or IP range to filter.</p>
</div>
        </tr>
      
        <li>
          <span class="name">:referer</span>
          <span class="type">(<tt>String</tt>, <tt>Regexp</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>The Referer URL or pattern to filter.</p>
</div>
        </tr>
      
        <li>
          <span class="name">:user_agent</span>
          <span class="type">(<tt>String</tt>, <tt>Regexp</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>The User-Agent string to filter.</p>
</div>
        </tr>
      
        <li>
          <span class="name">:when</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>Custom logic to filter requests by.</p>
</div>
        </tr>
      
    </ul>
  
<h3>Since:</h3>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>0.3.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


130
131
132</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/web/middleware/proxy.rb', line 130</span>

<span class='def def kw'>def</span> <span class='intercept identifier id'>intercept</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='@rule ivar id'>@rule</span> <span class='assign token'>=</span> <span class='Rule constant id'>Rule</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="proxy-instance_method">
  
    - (<tt><span class='object_link'><a href="Response.html" title="Ronin::Web::Middleware::Response (class)">Response</a></span></tt>) <strong>proxy</strong>(request)  <span class="extras">(protected)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong> 
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Proxies a request.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>request</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ProxyRequest.html" title="Ronin::Web::Middleware::ProxyRequest (class)">ProxyRequest</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The request to send.</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Response.html" title="Ronin::Web::Middleware::Response (class)">Response</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The response from the request.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/web/middleware/proxy.rb', line 230</span>

<span class='def def kw'>def</span> <span class='proxy identifier id'>proxy</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span>
    <span class='symbol val'>:ssl</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='scheme identifier id'>scheme</span> <span class='eq op'>==</span> <span class='string val'>'https'</span><span class='rparen token'>)</span><span class='comma token'>,</span>
    <span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='host identifier id'>host</span><span class='comma token'>,</span>
    <span class='symbol val'>:port</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='port identifier id'>port</span><span class='comma token'>,</span>
    <span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='request_method identifier id'>request_method</span><span class='comma token'>,</span>
    <span class='symbol val'>:path</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='path_info identifier id'>path_info</span><span class='comma token'>,</span>
    <span class='symbol val'>:query</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='query_string identifier id'>query_string</span><span class='comma token'>,</span>
    <span class='symbol val'>:content_type</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='content_type identifier id'>content_type</span><span class='comma token'>,</span>
    <span class='symbol val'>:headers</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='headers identifier id'>headers</span>
  <span class='rbrace token'>}</span>

  <span class='if if kw'>if</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='form_data? fid id'>form_data?</span>
    <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:form_data</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='POST constant id'>POST</span>
  <span class='end end kw'>end</span>

  <span class='http_response identifier id'>http_response</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='dot token'>.</span><span class='http_request identifier id'>http_request</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='http_headers identifier id'>http_headers</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>

  <span class='http_response identifier id'>http_response</span><span class='dot token'>.</span><span class='each_capitalized identifier id'>each_capitalized</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
    <span class='unless unless kw'>unless</span> <span class='HEADERS_BLACKLIST constant id'>HEADERS_BLACKLIST</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
      <span class='http_headers identifier id'>http_headers</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='value identifier id'>value</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='return return kw'>return</span> <span class='Response constant id'>Response</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span>
    <span class='lparen token'>(</span><span class='http_response identifier id'>http_response</span><span class='dot token'>.</span><span class='body identifier id'>body</span> <span class='orop op'>||</span> <span class='string val'>''</span><span class='rparen token'>)</span><span class='comma token'>,</span>
    <span class='http_response identifier id'>http_response</span><span class='dot token'>.</span><span class='code identifier id'>code</span><span class='comma token'>,</span>
    <span class='http_headers identifier id'>http_headers</span>
  <span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Tue Jul 12 15:53:05 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.0 (ruby-1.8.7).
</div>

  </body>
</html>