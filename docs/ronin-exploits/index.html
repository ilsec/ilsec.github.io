<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf8" />
<title>
  File: README
  
    &mdash; Ronin Exploits Documentation
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: README</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1 id="ronin-exploits">Ronin Exploits</h1>

<ul>
  <li><a href="https://github.com/ronin-ruby/ronin-exploits">Source</a></li>
  <li><a href="https://github.com/ronin-ruby/ronin-exploits/issues">Issues</a></li>
  <li><a href="http://rubydoc.info/github/ronin-ruby/ronin-exploits/frames">Documentation</a></li>
  <li><a href="http://groups.google.com/group/ronin-ruby">Mailing List</a></li>
  <li>irc.freenode.net #ronin</li>
</ul>

<h2 id="description">Description</h2>

<p>Ronin Exploits is a Ruby library for Ronin that provides exploitation and
payload crafting functionality.</p>

<p>Ronin is a Ruby platform for exploit development and security research.
Ronin allows for the rapid development and distribution of code, exploits
or payloads over many common Source-Code-Management (SCM) systems.</p>

<h3 id="ruby">Ruby</h3>

<p>Ronin&rsquo;s Ruby environment allows security researchers to leverage Ruby with
ease. The Ruby environment contains a multitude of convenience methods
for working with data in Ruby, a Ruby Object Database, a customized Ruby
Console and an extendable command-line interface.</p>

<h3 id="extend">Extend</h3>

<p>Ronin&rsquo;s more specialized features are provided by additional Ronin
libraries, which users can choose to install. These libraries can allow
one to write and run Exploits and Payloads, scan for PHP vulnerabilities,
perform Google Dorks  or run 3rd party scanners.</p>

<h3 id="publish">Publish</h3>

<p>Ronin allows users to publish and share code, exploits, payloads or other
data via Overlays. Overlays are directories of code and data that can be
hosted on any SVN, Hg, Git or Rsync server. Ronin makes it easy to create,
install or update Overlays.</p>

<h2 id="features">Features</h2>

<ul>
  <li>Define Exploits based on:
    <ul>
      <li>Whether they are local or remote.</li>
      <li>Protocol they use.</li>
      <li>Contributing authors.</li>
      <li>Exploited behaviors.</li>
      <li>Resources they leverage.</li>
      <li>Disclosure status.</li>
      <li>Level of weaponization.</li>
      <li>Architectures they target.</li>
      <li>OSes they target.</li>
      <li>Products they target.</li>
    </ul>
  </li>
  <li>Define Payloads based on:
    <ul>
      <li>Contributing authors.</li>
      <li>Resources they leverage.</li>
      <li>Helpers they use.</li>
    </ul>
  </li>
  <li>Define Payload Encoders:
    <ul>
      <li>Architectures they target.</li>
      <li>OSes they target.</li>
    </ul>
  </li>
  <li>Provides a simple three phase process of building, verifying and
deploying Exploits and Payloads.</li>
  <li>Allows adding arbitrary target data to the targets of Exploits.</li>
  <li>Allows combining Payloads with Exploits.</li>
  <li>Allows using a raw-payload with an Exploit.</li>
  <li>Allows the addition of multiple Payload Encoders to an Exploit.</li>
  <li>Allows chaining multiple Payloads together.</li>
  <li>Provides the following Exploit classes:
    <ul>
      <li><span class='object_link'><a href="Ronin/Exploits/Exploit.html" title="Ronin::Exploits::Exploit (class)">Ronin::Exploits::Exploit</a></span></li>
      <li><span class='object_link'><a href="Ronin/Exploits/Local.html" title="Ronin::Exploits::Local (class)">Ronin::Exploits::Local</a></span></li>
      <li><span class='object_link'><a href="Ronin/Exploits/Remote.html" title="Ronin::Exploits::Remote (class)">Ronin::Exploits::Remote</a></span></li>
      <li><span class='object_link'><a href="Ronin/Exploits/RemoteTCP.html" title="Ronin::Exploits::RemoteTCP (class)">Ronin::Exploits::RemoteTCP</a></span></li>
      <li><span class='object_link'><a href="Ronin/Exploits/RemoteUDP.html" title="Ronin::Exploits::RemoteUDP (class)">Ronin::Exploits::RemoteUDP</a></span></li>
      <li><span class='object_link'><a href="Ronin/Exploits/HTTP.html" title="Ronin::Exploits::HTTP (class)">Ronin::Exploits::HTTP</a></span></li>
      <li><span class='object_link'><a href="Ronin/Exploits/FTP.html" title="Ronin::Exploits::FTP (class)">Ronin::Exploits::FTP</a></span></li>
      <li><span class='object_link'><a href="Ronin/Exploits/Web.html" title="Ronin::Exploits::Web (class)">Ronin::Exploits::Web</a></span></li>
    </ul>
  </li>
  <li>Provides the following Exploit helpers:
    <ul>
      <li><span class='object_link'><a href="Ronin/Exploits/Helpers/Binary.html" title="Ronin::Exploits::Helpers::Binary (module)">Ronin::Exploits::Helpers::Binary</a></span></li>
      <li><span class='object_link'><a href="Ronin/Exploits/Helpers/Padding.html" title="Ronin::Exploits::Helpers::Padding (module)">Ronin::Exploits::Helpers::Padding</a></span></li>
      <li><span class='object_link'><a href="Ronin/Exploits/Helpers/BufferOverflow.html" title="Ronin::Exploits::Helpers::BufferOverflow (module)">Ronin::Exploits::Helpers::BufferOverflow</a></span></li>
      <li><span class='object_link'><a href="Ronin/Exploits/Helpers/FormatString.html" title="Ronin::Exploits::Helpers::FormatString (module)">Ronin::Exploits::Helpers::FormatString</a></span></li>
      <li><span class='object_link'><a href="Ronin/Exploits/Helpers/FileBuilder.html" title="Ronin::Exploits::Helpers::FileBuilder (module)">Ronin::Exploits::Helpers::FileBuilder</a></span></li>
    </ul>
  </li>
  <li>Provides the following Payload classes:
    <ul>
      <li><span class='object_link'><a href="Ronin/Payloads/Payload.html" title="Ronin::Payloads::Payload (class)">Ronin::Payloads::Payload</a></span></li>
      <li><span class='object_link'><a href="Ronin/Payloads/BinaryPayload.html" title="Ronin::Payloads::BinaryPayload (class)">Ronin::Payloads::BinaryPayload</a></span></li>
      <li><span class='object_link'><a href="Ronin/Payloads/ASMPayload.html" title="Ronin::Payloads::ASMPayload (class)">Ronin::Payloads::ASMPayload</a></span></li>
      <li><span class='object_link'><a href="Ronin/Payloads/Nops.html" title="Ronin::Payloads::Nops (class)">Ronin::Payloads::Nops</a></span></li>
      <li><span class='object_link'><a href="Ronin/Payloads/Shellcode.html" title="Ronin::Payloads::Shellcode (class)">Ronin::Payloads::Shellcode</a></span></li>
      <li><span class='object_link'><a href="Ronin/Payloads/BindShell.html" title="Ronin::Payloads::BindShell (class)">Ronin::Payloads::BindShell</a></span></li>
    </ul>
  </li>
  <li>Provides the following Payload helpers:
    <ul>
      <li><span class='object_link'><a href="Ronin/Payloads/Helpers/BindShell.html" title="Ronin::Payloads::Helpers::BindShell (module)">Ronin::Payloads::Helpers::BindShell</a></span></li>
    </ul>
  </li>
  <li>Provides an API for Post-Exploitation (<span class='object_link'><a href="Ronin/PostExploitation.html" title="Ronin::PostExploitation (module)">Ronin::PostExploitation</a></span>).</li>
  <li>Provides a multitude of exploit and payload generators which can create
customized skeleton Ruby Exploits and Payloads.</li>
</ul>

<h2 id="synopsis">Synopsis</h2>

<p>Generate a skeleton exploit, with some custom information:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='gen identifier id'>gen</span> <span class='exploit identifier id'>exploit</span> <span class='example_exploit identifier id'>example_exploit</span><span class='dot token'>.</span><span class='rb identifier id'>rb</span> \
    <span class='minus op'>-</span><span class='minus op'>-</span><span class='name identifier id'>name</span> <span class='Example constant id'>Example</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='arch identifier id'>arch</span> <span class='i686 identifier id'>i686</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='os identifier id'>os</span> <span class='Linux constant id'>Linux</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='product identifier id'>product</span> <span class='string val'>&quot;Example Product&quot;</span> \
    <span class='minus op'>-</span><span class='minus op'>-</span><span class='status identifier id'>status</span> <span class='proven identifier id'>proven</span> \
    <span class='minus op'>-</span><span class='minus op'>-</span><span class='authors identifier id'>authors</span> <span class='Postmodern constant id'>Postmodern</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='description identifier id'>description</span> <span class='string val'>&quot;This is an example.&quot;</span> \
    <span class='minus op'>-</span><span class='minus op'>-</span><span class='exploits identifier id'>exploits</span> <span class='file_read identifier id'>file_read</span> <span class='file_write identifier id'>file_write</span> \
    <span class='minus op'>-</span><span class='minus op'>-</span><span class='leverages identifier id'>leverages</span> <span class='shell identifier id'>shell</span>
</pre>

<ul>
  <li>To generate other types of exploits, you can specify <code>local_exploit</code>,
<code>remote_exploit</code>, <code>remote_tcp_exploit</code>, <code>remote_udp_exploit</code>,
<code>ftp_exploit</code>, <code>http_exploit</code> or <code>web_exploit</code>, instead of simply
<code>exploit</code>.</li>
</ul>

<p>Generate a skeleton payload, with some custom information:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='gen identifier id'>gen</span> <span class='payload identifier id'>payload</span> <span class='example_payload identifier id'>example_payload</span><span class='dot token'>.</span><span class='rb identifier id'>rb</span> \
    <span class='minus op'>-</span><span class='minus op'>-</span><span class='name identifier id'>name</span> <span class='Example constant id'>Example</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='arch identifier id'>arch</span> <span class='i686 identifier id'>i686</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='os identifier id'>os</span> <span class='Linux constant id'>Linux</span> \
    <span class='minus op'>-</span><span class='minus op'>-</span><span class='authors identifier id'>authors</span> <span class='Postmodern constant id'>Postmodern</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='description identifier id'>description</span> <span class='string val'>&quot;This is an example.&quot;</span> \
    <span class='minus op'>-</span><span class='minus op'>-</span><span class='leverages identifier id'>leverages</span> <span class='fs identifier id'>fs</span>
</pre>

<ul>
  <li>To generate other types of payloads, you can specify <code>binary_payload</code>,
<code>shellcode</code> or <code>nops</code>, instead of simply <code>payload</code>.</li>
</ul>

<p>List available exploits:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='exploits identifier id'>exploits</span>
</pre>

<p>Print information about an exploit:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='exploits identifier id'>exploits</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='NAME constant id'>NAME</span> <span class='minus op'>-</span><span class='v identifier id'>v</span>
</pre>

<p>Build and deploy an exploit:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='exploit identifier id'>exploit</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='NAME constant id'>NAME</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='host identifier id'>host</span> <span class='example identifier id'>example</span><span class='dot token'>.</span><span class='com identifier id'>com</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='port identifier id'>port</span> <span class='integer val'>9999</span>
</pre>

<p>Load an exploit from a file, then build and deploy it:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='exploit identifier id'>exploit</span> <span class='minus op'>-</span><span class='f identifier id'>f</span> <span class='FILE constant id'>FILE</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='host identifier id'>host</span> <span class='example identifier id'>example</span><span class='dot token'>.</span><span class='com identifier id'>com</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='port identifier id'>port</span> <span class='integer val'>9999</span>
</pre>

<p>Build and deploy an exploit, with a payload:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='exploit identifier id'>exploit</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='NAME constant id'>NAME</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='host identifier id'>host</span> <span class='example identifier id'>example</span><span class='dot token'>.</span><span class='com identifier id'>com</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='port identifier id'>port</span> <span class='integer val'>9999</span> <span class='minus op'>-</span><span class='P constant id'>P</span> <span class='PAYLOAD_NAME constant id'>PAYLOAD_NAME</span>
</pre>

<p>Build and deploy an exploit, with a raw payload:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='exploit identifier id'>exploit</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='NAME constant id'>NAME</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='host identifier id'>host</span> <span class='example identifier id'>example</span><span class='dot token'>.</span><span class='com identifier id'>com</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='port identifier id'>port</span> <span class='integer val'>9999</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='raw identifier id'>raw</span><span class='minus op'>-</span><span class='payload identifier id'>payload</span> \
    <span class='xstring val'>`echo -en &quot;\x66\x31\xc0\xfe\xc0\xb3\xff\xcd\x80&quot;`</span>
</pre>

<p>List available payloads:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='payloads identifier id'>payloads</span>
</pre>

<p>Print information about a payload:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='payloads identifier id'>payloads</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='NAME constant id'>NAME</span> <span class='minus op'>-</span><span class='v identifier id'>v</span>
</pre>

<p>Build and output a payload:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='payload identifier id'>payload</span> <span class='NAME constant id'>NAME</span>
</pre>

<p>Build and output a raw unescaped payload:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='payload identifier id'>payload</span> <span class='NAME constant id'>NAME</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='raw identifier id'>raw</span>
</pre>

<p>Load a payload from a file, then build and output it:</p>

<pre class="code">$ <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='payload identifier id'>payload</span> <span class='minus op'>-</span><span class='f identifier id'>f</span> <span class='FILE constant id'>FILE</span>
</pre>

<h2 id="examples">Examples</h2>

<p>Define a remote TCP exploit:</p>

<pre class="code"><span class='Ronin constant id'>Ronin</span><span class='colon2 op'>::</span><span class='Exploits constant id'>Exploits</span><span class='colon2 op'>::</span><span class='RemoteTCP constant id'>RemoteTCP</span><span class='dot token'>.</span><span class='object identifier id'>object</span> <span class='do do kw'>do</span>

  <span class='helper identifier id'>helper</span> <span class='symbol val'>:buffer_overflow</span>

  <span class='comment val'>#</span>
  <span class='comment val'># Cacheable data.</span>
  <span class='comment val'>#</span>
  <span class='cache identifier id'>cache</span> <span class='do do kw'>do</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='string val'>'test'</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='description identifier id'>description</span> <span class='assign token'>=</span> <span class='string val'>%{This is an example exploit.}</span>

    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='status identifier id'>status</span> <span class='assign token'>=</span> <span class='symbol val'>:potential</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='released identifier id'>released</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>

    <span class='author identifier id'>author</span><span class='lparen token'>(</span><span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Postmodern'</span><span class='comma token'>,</span> <span class='symbol val'>:organization</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'SophSec'</span><span class='rparen token'>)</span>

    <span class='exploits identifier id'>exploits</span> <span class='symbol val'>:file_read</span><span class='comma token'>,</span> <span class='symbol val'>:file_write</span>

    <span class='targeting identifier id'>targeting</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='t identifier id'>t</span><span class='bitor op'>|</span>
      <span class='t identifier id'>t</span><span class='dot token'>.</span><span class='arch! fid id'>arch!</span> <span class='symbol val'>:x86</span>
      <span class='t identifier id'>t</span><span class='dot token'>.</span><span class='os! fid id'>os!</span> <span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Linux'</span>
      <span class='t identifier id'>t</span><span class='dot token'>.</span><span class='product! fid id'>product!</span> <span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'ExampleWare'</span><span class='comma token'>,</span> <span class='symbol val'>:version</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'2.4.7b'</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='comment val'>#</span>
  <span class='comment val'># Builds the exploit.</span>
  <span class='comment val'>#</span>
  <span class='build identifier id'>build</span> <span class='do do kw'>do</span>
    <span class='@buffer ivar id'>@buffer</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;USER #{build_buffer}\n&quot;</span>
  <span class='end end kw'>end</span>

  <span class='comment val'>#</span>
  <span class='comment val'># Deploys the built exploit.</span>
  <span class='comment val'>#</span>
  <span class='deploy identifier id'>deploy</span> <span class='do do kw'>do</span>
    <span class='tcp_send identifier id'>tcp_send</span> <span class='@buffer ivar id'>@buffer</span>
  <span class='end end kw'>end</span>

  <span class='comment val'>#</span>
  <span class='comment val'># Evacuates the deployed exploit.</span>
  <span class='comment val'>#</span>
  <span class='evacuate identifier id'>evacuate</span> <span class='do do kw'>do</span>
    <span class='tcp_send identifier id'>tcp_send</span> <span class='string val'>&quot;QUIT&quot;</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre>

<p>Define a shellcode payload:</p>

<pre class="code"><span class='Ronin constant id'>Ronin</span><span class='colon2 op'>::</span><span class='Payloads constant id'>Payloads</span><span class='colon2 op'>::</span><span class='Shellcode constant id'>Shellcode</span><span class='dot token'>.</span><span class='object identifier id'>object</span> <span class='do do kw'>do</span>

  <span class='comment val'>#</span>
  <span class='comment val'># Cacheable data.</span>
  <span class='comment val'>#</span>
  <span class='cache identifier id'>cache</span> <span class='do do kw'>do</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='string val'>'test'</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='version identifier id'>version</span> <span class='assign token'>=</span> <span class='string val'>'0.5'</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='description identifier id'>description</span> <span class='assign token'>=</span> <span class='string val'>%{This is an example shellcode payload.}</span>

    <span class='author identifier id'>author</span><span class='lparen token'>(</span><span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Postmodern'</span><span class='comma token'>,</span> <span class='symbol val'>:organization</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'SophSec'</span><span class='rparen token'>)</span>

    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='arch! fid id'>arch!</span> <span class='symbol val'>:x86</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='os! fid id'>os!</span> <span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Linux'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'>#</span>
  <span class='comment val'># Configurable parameters.</span>
  <span class='comment val'>#</span>
  <span class='parameter identifier id'>parameter</span> <span class='symbol val'>:exit_status</span><span class='comma token'>,</span>
            <span class='symbol val'>:type</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Integer constant id'>Integer</span><span class='comma token'>,</span>
            <span class='symbol val'>:default</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='comma token'>,</span>
            <span class='symbol val'>:description</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Exit status of shellcode'</span>

  <span class='comment val'>#</span>
  <span class='comment val'># Builds the assembly payload, which will call the SYS_EXIT</span>
  <span class='comment val'># syscall with the exit_status of the shellcode.</span>
  <span class='comment val'>#</span>
  <span class='build identifier id'>build</span> <span class='do do kw'>do</span>
    <span class='@payload ivar id'>@payload</span> <span class='assign token'>=</span> <span class='string val'>&quot;\x66\x31\xc0\xfe\xc0&quot;</span>

    <span class='unless unless kw'>unless</span> <span class='@exit_status ivar id'>@exit_status</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
      <span class='@payload ivar id'>@payload</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;\xb3#{@exit_status.chr}&quot;</span>
    <span class='else else kw'>else</span>
      <span class='@payload ivar id'>@payload</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&quot;\x66\x31\xdb&quot;</span>
    <span class='end end kw'>end</span>

    <span class='@payload ivar id'>@payload</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&quot;\xcd\x80&quot;</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre>

<p>Define a payload encoder:</p>

<pre class="code"><span class='Ronin constant id'>Ronin</span><span class='colon2 op'>::</span><span class='Encoders constant id'>Encoders</span><span class='colon2 op'>::</span><span class='Encoder constant id'>Encoder</span><span class='dot token'>.</span><span class='object identifier id'>object</span> <span class='do do kw'>do</span>

  <span class='comment val'>#</span>
  <span class='comment val'># Cacheable data.</span>
  <span class='comment val'>#</span>
  <span class='cache identifier id'>cache</span> <span class='do do kw'>do</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='string val'>'base64_encode'</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='description identifier id'>description</span> <span class='assign token'>=</span> <span class='string val'>%{Example base64 payload encoder}</span>

    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='arch identifier id'>arch</span> <span class='symbol val'>:x86</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='os identifier id'>os</span> <span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Linux'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'>#</span>
  <span class='comment val'># Base64 encodes the specified _data_.</span>
  <span class='comment val'>#</span>
  <span class='def def kw'>def</span> <span class='encode identifier id'>encode</span><span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='base64_encode identifier id'>base64_encode</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre>

<h2 id="requirements">Requirements</h2>

<ul>
  <li><a href="https://github.com/postmodern/open-namespace/">open_namespace</a> ~&gt; 0.3</li>
  <li><a href="https://github.com/postmodern/data_paths/">data_paths</a> ~&gt; 0.3</li>
  <li><a href="https://github.com/postmodern/uri-query_params">uri-query_params</a> ~&gt; 0.5, &gt;= 0.5.2</li>
  <li><a href="https://github.com/ronin-ruby/ronin-support">ronin-support</a> ~&gt; 0.2</li>
  <li><a href="https://github.com/ronin-ruby/ronin">ronin</a> ~&gt; 1.1</li>
  <li><a href="https://github.com/ronin-ruby/ronin-gen">ronin-gen</a> ~&gt; 1.0</li>
</ul>

<h2 id="install">Install</h2>

<pre class="code">$ <span class='gem identifier id'>gem</span> <span class='install identifier id'>install</span> <span class='ronin identifier id'>ronin</span><span class='minus op'>-</span><span class='exploits identifier id'>exploits</span>
</pre>

<h2 id="license">License</h2>

<p>Ronin Exploits - A Ruby library for Ronin that provides exploitation and
payload crafting functionality.</p>

<p>Copyright (c) 2007-2011 Hal Brodigan (postmodern.mod3 at gmail.com)</p>

<p>This file is part of Ronin Exploits.</p>

<p>Ronin is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>

<p>Ronin is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>

<p>You should have received a copy of the GNU General Public License
along with Ronin.  If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>
</div></div>
    
    <div id="footer">
  Generated on Tue Jul 12 15:56:26 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.1 (ruby-1.8.7).
</div>

  </body>
</html>